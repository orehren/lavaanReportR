---
title: "Introduction to lavaanReportR"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to lavaanReportR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

`lavaanReportR` is an R package designed to simplify the creation of
publication-ready path diagrams for structural equation models fitted with the
`lavaan` package. This vignette provides a step-by-step guide to using the
package's core workflow.

## The `lavaanReportR` Workflow

The package uses a five-step pipeline to create plots:

1.  **`analyze()`**: Extracts the model structure.
2.  **`configure_plot()`**: Customizes the plot's appearance.
3.  **`prepare()`**: Prepares the final data for plotting.
4.  **`build()`**: Constructs the DOT code for the plot.
5.  **`render()`**: Renders the final plot.

## A Complete Example

Let's walk through a complete example using the `PoliticalDemocracy` dataset
from the `lavaan` package.

### 1. Load the Packages and Data

First, we need to load the `lavaan` and `lavaanReportR` packages.

```{r}
library(lavaan)
library(lavaanReportR)
```

### 2. Fit a `lavaan` Model

Next, we'll define and fit a simple structural equation model.

```{r}
model <- '
  # measurement model
    ind60 =~ x1 + x2 + x3
    dem60 =~ y1 + y2 + y3 + y4
    dem65 =~ y5 + y6 + y7 + y8
  # structural model
    dem60 ~ ind60
    dem65 ~ ind60 + dem60
'
fit <- sem(model, data = PoliticalDemocracy)
```

### 3. Get the Parameter Table

The `lavaanReportR` workflow starts with a `lavaan` parameter table.

```{r}
param_table <- parameterEstimates(fit)
```

### 4. Run the Workflow

Now, we can run the `lavaanReportR` workflow to generate the plot.

```{r}
param_table |>
  analyze() |>
  configure_plot(
    plot_flow_direction = "LR",
    text_size_global = 10
  ) |>
  prepare() |>
  build() |>
  render()
```

This will produce a path diagram of the fitted model. You can customize the
plot's appearance by passing different arguments to the `configure_plot()`
function. For example, you can change the layout direction, font sizes, and
which elements are displayed.
